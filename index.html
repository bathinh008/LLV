<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>Đăng nhập</title>
<style>
body {
    font-family: Arial;
    display:flex; justify-content:center;
    align-items:center; height:100vh;
    background:#f4f6f9;
}
.box {
    background:#fff; padding:30px;
    width:320px; border-radius:10px;
    box-shadow:0 3px 10px rgba(0,0,0,0.2);
}
input {
    width:100%; padding:10px;
    margin-bottom:12px; border:1px solid #ccc;
    border-radius:6px;
    font-size:14px;
}
button {
    width:100%; padding:10px;
    background:#3498db; color:#fff;
    border:none; border-radius:6px;
    cursor:pointer;
}
button:hover { background:#2980b9; }
h2 { text-align:center; margin-bottom:20px; }
</style>
</head>
<body>

<div class="box">
    <h2>Đăng nhập</h2>
    <input id="username" placeholder="Tên đăng nhập">
    <input id="password" placeholder="Mật khẩu" type="password">
    <button onclick="login()">Đăng nhập</button>
</div>

<script>
const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbzl1E3U28dTDzrDrWMQCf-GnoCk24ZMs4XMhJLI2sa49F5vS5dmxr4TIAHEGLb5O-BI/exec"; // <- THAY BẰNG URL Web App

async function login() {
    const u = document.getElementById("username").value.trim();
    const p = document.getElementById("password").value.trim();

    if (!u || !p) {
        alert("Nhập đủ tên đăng nhập và mật khẩu");
        return;
    }

    try {
        const res = await fetch(
            `${SCRIPT_URL}?action=login&username=${encodeURIComponent(u)}&password=${encodeURIComponent(p)}`
        );
        const json = await res.json();

        if (!json.success) {
            alert("Sai tài khoản hoặc mật khẩu!");
            return;
        }

        // lưu vào localStorage
        localStorage.setItem("scriptUrl", SCRIPT_URL);
        localStorage.setItem("username", json.username || u);
        localStorage.setItem("group", json.group || "");
        localStorage.setItem("role", json.role || "user");

        // chuyển sang dashboard
        window.location.href = "dashboard.html";
    } catch (err) {
        console.error(err);
        alert("Không kết nối được Apps Script. Kiểm tra lại URL Web App.");
    }
}
</script>

</body>
</html>


